import java.text.SimpleDateFormat;
import java.util.Arrays;
import java.util.Date;

public class Vulnerability {
    public String cveIdentifier;
    public Date publishedAt;
    public String[] cweIds;
    public double cvssScore;
    public String severity;
    public String scope;
    public String cpeConfidence;
    public Integer evidenceCount;

    public String toCsvLine() {
        String cweIdString = Arrays.toString(cweIds);
        cweIdString = cweIdString.substring(1,cweIdString.length()-1);
        return String.format("%s;%s;%s;%s;%s;%s;%s;%s",
                cveIdentifier,
                emptyIfNull(getPublishedAtAsString()),
                cweIdString,
                emptyIfNull(cvssScore),
                emptyIfNull(severity),
                emptyIfNull(scope),
                emptyIfNull(cpeConfidence),
                emptyIfNull(evidenceCount)
        );
    }

    public String getCveIdentifier() {
        return cveIdentifier;
    }

    public void setCveIdentifier(String cveIdentifier) {
        this.cveIdentifier = cveIdentifier;
    }

    public Date getPublishedAt() {
        return publishedAt;
    }
    
    public String getPublishedAtAsString() {
        if(publishedAt == null) {
            return null;
        }
        return new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSS").format(publishedAt);
    }

    public void setPublishedAt(Date publishedAt) {
        this.publishedAt = publishedAt;
    }

    public String[] getCweIds() {
        return cweIds;
    }

    public String getCWEIdsAsString() {
        return Arrays.toString(cweIds);
    }

    public void setCweIds(String[] cweIds) {
        this.cweIds = cweIds;
    }

    public double getCvssScore() {
        return cvssScore;
    }

    public void setCvssScore(double cvssScore) {
        this.cvssScore = cvssScore;
    }

    public String getSeverity() {
        return severity;
    }

    public void setSeverity(String severity) {
        this.severity = severity;
    }

    public String getScope() {
        return scope;
    }

    public void setScope(String scope) {
        this.scope = scope;
    }

    public String getCpeConfidence() {
        return cpeConfidence;
    }

    public void setCpeConfidence(String cpeConfidence) {
        this.cpeConfidence = cpeConfidence;
    }

    public Integer getEvidenceCount() {
        return evidenceCount;
    }

    public void setEvidenceCount(Integer evidenceCount) {
        this.evidenceCount = evidenceCount;
    }

    private String emptyIfNull(Object object) {
        if(object == null) {
            return "";
        }
        else {
            return object.toString();
        }
    }
}
